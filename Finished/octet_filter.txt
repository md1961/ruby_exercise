B004:ログファイルの抽出

あなたは管理しているサーバーのアクセスログから、特定のIPのアクセスを抽出しようとしています。
IPアドレスを指定する書式の例は以下のようになっており、IPv4のみを対象としています。

※ # 以降はコメントです。
192.168.0.1            #192.168.0.1のみを対象
192.168.0.[10-20]      #192.168.0.10~192.168.0.20の範囲を対象
192.168.[1-2].[10-20]  #192.168.1.10~192.168.1.20と192.168.2.10~192.168.2.20の範囲を対象
192.168.0.*            #192.168.0.0~192.168.0.255の範囲を対象
192.168.*.*            #192.168.0.0~192.168.255.255の範囲を対象
　                     #*は[0-255]と等価

IPアドレスは「.」で区切られて左から第1.第2.第3.第4オクテットと呼ばれます。
範囲指定ができるのは第3、第4オクテットまでとします。
Apacheのログが以下のような書式であります。ログは上から古い順に記録されているとします。

「IPアドレス identユーザー名 認証ユーザー名 [アクセス日時] "リクエストヘッダ ファイル名 プロトコル" ステータスコード 転送されたバイト数 呼び出し元URL ブラウザ情報等」

1. IPアドレス
2. identユーザー名
3. 認証ユーザー名
4. [アクセス日時]
5. "リクエストヘッダ ファイル名 プロトコル"
6. ステータスコード
7. 転送されたバイト数
8. 呼び出し元URL
9. ブラウザ情報等
※半角スペース区切り

101.80.23.49 - - [08/Jul/2013:16:55:14 +0900] "GET /index.html HTTP/1.1" 200 12345 "http://google.com" "safari"
51.185.9.25 - - [08/Jul/2013:17:05:10 +0900] "GET / HTTP/1.1" 200 12345 "http://google.com" "chrome"
……

日付のフォーマットは[日付/月/西暦4桁:時:分:秒 タイムゾーン]で入力されます。
各値は0詰めされてるとします。
月の表記はそれぞれ1月から順に以下のように記録されています。

Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec
……

抽出対象のIPアドレスの指定、入力されるログの行数、ログの入力から対象のアクセスを抽出し、
IPアドレス、タイムゾーンの指定を除外した日付、ファイル名をスペース区切りで
出力するプログラムを作成してください。

評価ポイント
10個のテストケースを入力し、正答数と解答の提出までに要した時間を測定し得点が決まります。 
※制限時間を超えるとテストケースが通っても失格(0点)となります。
※提出いただいたコードは複数回実行され、一度の実行では1つのテストケースのみ入力
得点の計算方法：正解数得点(50点) ＋ 正解率×回答時間得点(40分以内で50点、80分で25点、2時間で0点と線形に点数が落ちます)
複数のテストケースで正しい出力がされるか評価（+50点）
解答までの速さ評価（+50点）

入力される値
1行目に検索条件として、IPアドレスが入力されます。範囲指定も可能で第3、第4オクテットは* (0から255全て)、[S-E] (SからEまで)で指定することが可能です。
2行目には入力されるログの行数Nが入力されます。
3行目以降には2行目で入力された行数分のApacheのログが入力されます。ログ１行の長さMは500文字以内とします。

期待する出力
入力されたIPアドレスの範囲のIPアドレスを入力されたログから抽出し、IPアドレス、日付(+9000等のタイムゾーンの表記なし)、ファイル名をスペース区切りで日付の古い順に出力してください。
192.168.186.70 10/Jul/2013:18:52:12 /top.html

条件
IPアドレスはIPv4の0.0.0.0から255.255.255.255までとします。
予約アドレス等の特殊なアドレスの入力に関しては考慮しなくてよいものとします。
最大で192.168.*.*のような入力の場合192.168.0.0~192.168.255.255の
65536アドレスを対象とする場合があります。
S < E
0 ≦ S,E ≦ 255
1 ≦ N ≦ 1000
M ≦ 500

入力例
192.168.186.70
3
192.168.110.238 - - [10/Jul/2013:18:40:43 +0900] "GET /top.html HTTP/1.1" 404 8922 "http://gi-no.jp" "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/27.0.1453.116 Safari/537.36"
192.168.186.70 - - [10/Jul/2013:18:52:12 +0900] "GET /top.html HTTP/1.1" 404 3628 "http://facebook.com" "Mozilla/5.0 (Windows NT 5.1; rv:22.0) Gecko/20100101 Firefox/22.0"
192.168.105.56 - - [10/Jul/2013:20:13:52 +0900] "GET /top.html HTTP/1.1" 200 1863 "http://paiza.jp" "Mozilla/5.0 (iPad; CPU OS 6_0_1 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A523 Safari/8536.25"

出力例
192.168.186.70 10/Jul/2013:18:52:12 /top.html

入力例2
192.168.[0-100].*
3
192.168.99.112 - - [10/Jul/2013:13:53:15 +0900] "GET /top.html HTTP/1.1" 404 1426 "http://facebook.com" "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/27.0.1453.116 Safari/537.36"
192.168.81.20 - - [10/Jul/2013:15:06:33 +0900] "GET /hogehoge.html HTTP/1.1" 404 4374 "http://paiza.jp" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/27.0.1453.116 Safari/537.36"
192.168.223.58 - - [10/Jul/2013:21:32:01 +0900] "GET /hoge.html HTTP/1.1" 304 6601 "http://paiza.jp" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.8; rv:22.0) Gecko/20100101 Firefox/22.0"

出力例2
192.168.99.112 10/Jul/2013:13:53:15 /top.html
192.168.81.20 10/Jul/2013:15:06:33 /hogehoge.html
